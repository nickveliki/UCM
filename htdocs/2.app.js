(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{27:function(e,t){var n=[],r=function(e,t,n){for(var r=n.map((function(e){return e})),o=Math.round(r.length/2);r.length>1;)t<r[o][e]?r.splice(o,r.length-o):r.splice(0,o),o=Math.round(r.length/2);return r[0]&&r[0][e]===t?n.indexOf(r[0]):-1};e.exports={setState:function(e,t){var o,a,i=r("name",t,n);-1!=i&&(o=n[i].pickupstate,a=e,Object.keys(a).forEach((function(e){o[e]=a[e]})))},register:function(e){-1==r("name",e,n)&&(n.push({name:e,pickupstate:{}}),n.sort((function(e,t){return e.name-t.name})))},searchArray:r,getState:function(e){var t=r("name",e,n);if(-1!=t){var o=n[t].pickupstate;return n[t].pickupstate={},o}}}},29:function(e,t,n){(function(t){e.exports={verifySignature:function(e,n,r){return new Promise((function(o,a){e?crypto.subtle.importKey("spki",t.from(r,"base64").buffer,{name:"RSA-PSS",modulusLength:1024,hash:"SHA-256"},!1,["verify"]).then((function(r){crypto.subtle.verify({name:"RSA-PSS",saltLength:32},r,t.from(e,"base64").buffer,t.from(n)).then(o).catch(a)})).catch(a):o(!1)}))},unwrapAES:function(e,n){return new Promise((function(r,o){crypto.subtle.importKey("pkcs8",t.from(n,"base64").buffer,{name:"RSA-OAEP",hash:"SHA-256"},!1,["unwrapKey"]).then((function(n){crypto.subtle.unwrapKey("raw",t.from(e,"base64").buffer,n,{name:"RSA-OAEP"},{name:"AES-GCM"},!1,["decrypt"]).then((function(e){r(e)})).catch((function(e){o(e)}))})).catch((function(e){o(e)}))}))},decryptMessage:function(e,n,r){return crypto.subtle.decrypt({name:"AES-GCM",iv:n},e,t.from(r,"base64").buffer)},encryptMessage:function(e){return new Promise((function(n,r){var o=crypto.getRandomValues(new Uint8Array(12));crypto.subtle.generateKey({name:"AES-GCM",length:128},!0,["encrypt","decrypt"]).then((function(a){crypto.subtle.encrypt({name:"AES-GCM",iv:o},a,t.from(e).buffer).then((function(e){n({AES:a,encrypted:t.from(e).toString("base64"),iv:o})})).catch((function(e){r(e)}))})).catch((function(e){r(e)}))}))},wrapAES:function(e,n){return new Promise((function(r,o){crypto.subtle.importKey("spki",t.from(n,"base64").buffer,{name:"RSA-OAEP",hash:"SHA-256"},!1,["wrapKey"]).then((function(n){crypto.subtle.wrapKey("raw",e,n,"RSA-OAEP").then((function(e){r(t.from(e).toString("base64"))})).catch((function(e){o(e)}))})).catch((function(e){o(e)}))}))},signMessage:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{name:"RSA-PSS",saltLength:32};return new Promise((function(o,a){var i=t.from(n,"base64").buffer;crypto.subtle.importKey("pkcs8",i,"RSA-PSS"===r.name?{name:"RSA-PSS",modulusLength:1024,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"}:{name:r.name,hash:"SHA-256"},!1,["sign"]).then((function(n){crypto.subtle.sign(r,n,t.from(e)).then((function(e){o(t.from(e).toString("base64"))})).catch(a)})).catch(a)}))}}}).call(this,n(28).Buffer)},30:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var r=n(0),o=n.n(r),a=n(35),i=n(34),s=n(27),c=n(29),u=n(12);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?h(e):t}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=function(t){function n(){var t,r;f(this,n);for(var u=arguments.length,l=new Array(u),p=0;p<u;p++)l[p]=arguments[p];return g(h(r=m(this,(t=y(n)).call.apply(t,[this].concat(l)))),"state",{inbox:!0,outbox:!1,messages:[],replytomessage:""}),g(h(r),"getMessages",(function(){fetch("/umc/"+r.props.me.fingerprint,{method:"GET"}).then((function(e){e.json().then((function(e){r.setState({messages:[]}),e.forEach((function(e,t){e.from===r.props.me.fingerprint||e.decrypted||r.readMessage(e.message,t,e.from,e.timestamp)}))}))}))})),g(h(r),"readMessage",(function(t,n,o,a){if(localStorage.getItem("contacts")){var i=JSON.parse(t.substring(t.indexOf("-----AES KEY START-----"),t.indexOf("-----AES KEY END-----")).replace("-----AES KEY START-----","").trim()),s=i.wrapped,u=e.from(Object.keys(i.iv).map((function(e){return i.iv[e]})));Object(c.unwrapAES)(s,r.props.me.privateKey).then((function(i){var s=t.split("-----MESSAGE BODY-----")[1].split("-----SENDER SIGNATURE-----")[0];Object(c.decryptMessage)(i,u,s).then((function(i){Object(c.verifySignature)(t.split("-----SENDER SIGNATURE-----")[1],i,r.resolveFrom(o).publicKey).then((function(t){console.log({verified:t}),r.state.messages.splice(n,1,{index:n,message:e.from(i).toString(),decrypted:!0,from:o,timestamp:a,verified:t}),r.setState({messages:r.state.messages})})).catch(console.log)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}})),g(h(r),"resolveFrom",(function(e){var t=JSON.parse(localStorage.getItem("contacts"))||[],n=Object(s.searchArray)("fingerprint",e,t);return-1!==n?t[n]:{fingerprint:e}})),g(h(r),"render",(function(){return o.a.createElement("div",null,o.a.createElement("div",{className:"IDBar"},o.a.createElement("h4",null,r.props.me.alias),o.a.createElement("div",{className:"linkContainer"},o.a.createElement("h5",null,r.props.me.fingerprint))),o.a.createElement("div",{className:"smallbar"},o.a.createElement("button",{onClick:function(){r.setState({inbox:!0,outbox:!1})}},"Inbox ",r.state.messages.length),o.a.createElement("button",{onClick:function(){r.setState({inbox:!1,outbox:!0})}},"Outbox")),o.a.createElement("div",null,r.state.inbox&&o.a.createElement(a.a,{fingerprint:r.props.me.fingerprint,messages:r.state.messages,resolveFrom:r.resolveFrom,reply:function(e){var t=e.fingerprint,n=e.replytomessage;r.props.setDestination(r.resolveFrom(t)),r.setState({replytomessage:n,inbox:!1,outbox:!0})}}),r.state.outbox&&o.a.createElement(i.a,{privateKey:r.props.me.privateKey,fingerprint:r.props.me.fingerprint,destination:r.props.destination,replytomessage:r.state.replytomessage,resolveFrom:r.resolveFrom,finish:function(){r.setState({replytomessage:""})}})))})),r}var r,l,d;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(n,t),r=n,(l=[{key:"componentDidMount",value:function(){var e=this;this.getMessages(),u.a.listenForPushEvents("new mail",(function(t){"YOU GOT MAIL"===JSON.parse(t.data).title&&(e.getMessages(),u.a.notify(t,(function(t){return"you have mail from ".concat(e.resolveFrom(t).alias)})))}))}}])&&p(r.prototype,l),d&&p(r,d),n}(o.a.Component)}).call(this,n(28).Buffer)},34:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var r=n(0),o=n.n(r),a=n(29),i=n(12);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?p(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(t){function n(){var t,r;c(this,n);for(var o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];return y(p(r=l(this,(t=f(n)).call.apply(t,[this].concat(s)))),"state",{sent:!1}),y(p(r),"submit",(function(t){t.preventDefault();var n=t.target.subject.value+"\r\n\n"+t.target.message.value;Object(a.encryptMessage)(n).then((function(t){var o=t.AES,s=t.encrypted,c=t.iv;Object(a.wrapAES)(o,r.props.destination.publicKey).then((function(t){Object(a.signMessage)(n,r.props.privateKey).then((function(n){var o="-----AES KEY START-----\r\n"+JSON.stringify({wrapped:t,iv:c})+"\r\n-----AES KEY END-----\r\n-----MESSAGE BODY-----\r\n"+e.from(s).toString()+"\r\n-----SENDER SIGNATURE-----"+n;fetch("/umc/message/"+r.props.fingerprint+"/"+r.props.destination.fingerprint+"/",{method:"POST",headers:{"Content-Type":"Application/json"},body:JSON.stringify({message:o})}).then((function(e){e.status<400&&(r.setState({sent:!0}),r.props.finish(),i.a.listenForPushEvents("message sent",(function(e){var t=JSON.parse(e.data),n=t.online;"MESSAGE SENT"===t.title&&i.a.notify(e,(function(e){return"".concat(r.props.resolveFrom(e).alias," is ").concat(n?"online, maybe they'll answer promptly":"offline. Don't hold your breath")}))})),setTimeout((function(){r.setState({sent:!1})}),5e3)),e.json().then((function(e){})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))})).catch(console.log)})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))})),r}var r,s,h;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(n,t),r=n,(s=[{key:"render",value:function(){return o.a.createElement("div",null,this.props.destination&&o.a.createElement("div",{className:"newMessage"},o.a.createElement("label",{className:"DestinationLabel"},'Destination: "',this.props.destination.alias,'" (',this.props.destination.fingerprint,") "),!this.state.sent&&o.a.createElement("form",{className:"MessageForm",onSubmit:this.submit},o.a.createElement("div",{className:"input-wrapper"},o.a.createElement("label",null,"Subject  "),o.a.createElement("input",{defaultValue:""===this.props.replytomessage?"":"Re: "+this.props.replytomessage.split("\r\n")[0],type:"text",name:"subject"})),o.a.createElement("textarea",{name:"message",defaultValue:""===this.props.replytomessage?"":"\r\n\n\n-----previous message from "+this.props.destination.alias+"-----\r\n\n"+this.props.replytomessage}),o.a.createElement("input",{type:"submit",value:"Send Message"})),this.state.sent&&o.a.createElement("dir",null,o.a.createElement("label",null,"message successfully sent to ",this.props.destination.alias))))}}])&&u(r.prototype,s),h&&u(r,h),n}(o.a.Component)}).call(this,n(28).Buffer)},35:function(e,t,n){"use strict";var r=n(0),o=n.n(r);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?l(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m=function(e){function t(){var e,n;i(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return p(l(n=c(this,(e=u(t)).call.apply(e,[this].concat(o)))),"state",{show:!1}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"MessageBox"},o.a.createElement("button",{onClick:function(){e.setState({show:!e.state.show})}},"From: ",this.props.from.alias?this.props.from.alias+(this.props.verified?" verified":" CAUTION: not verified"):"unregistered fingerprint"," ",new Date(this.props.timestamp).toLocaleTimeString()," (",this.state.show?"hide":"show",")"),o.a.createElement("label",null,this.props.from.fingerprint),this.state.show&&o.a.createElement("textarea",{value:this.props.message,readOnly:!0}),this.state.show&&o.a.createElement("button",{onClick:function(){e.props.reply({fingerprint:e.props.from.fingerprint,replytomessage:e.props.message})}},"Reply"))}}])&&s(n.prototype,r),a&&s(n,a),t}(o.a.Component);t.a=function(e){return o.a.createElement("div",{className:"MessagePanel"},e.messages.map((function(t,n){return o.a.createElement(m,{from:e.resolveFrom(t.from),message:t.message,timestamp:t.timestamp,key:n,verified:t.verified,reply:e.reply})})))}},37:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=function(e){return o.a.createElement("div",{className:"mini-container"},o.a.createElement("button",{onClick:function(){e.onClick(e.contact)}},e.contact.alias))},i=n(12);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?p(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=function(e){function t(){var e,n;c(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return y(p(n=l(this,(e=f(t)).call.apply(e,[this].concat(o)))),"state",{contacts:[]}),y(p(n),"getContacts",(function(){fetch("/umc/",{method:"GET"}).then((function(e){e.json().then((function(e){n.setState({contacts:e.filter((function(e){return!(n.props.myID&&n.props.myID()&&e.fingerprint==n.props.myID())}))}),localStorage.setItem("contacts",JSON.stringify(e))})).catch((function(e){console.log(e)}))})).catch((function(){n.setState({contacts:[]})}))})),n}var n,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){var e=this;this.getContacts(),i.a.listenForPushEvents("new user",(function(t){var n=t.data;"NEW USER"===JSON.parse(n).title&&e.getContacts()}))}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.interval)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"PanelLeft"},o.a.createElement("h3",null," Contacts"),o.a.createElement("div",{className:"contactList"},this.state.contacts.map((function(t,n){return o.a.createElement(a,{contact:t,key:n,onClick:e.props.selectDestination})}))))}}])&&u(n.prototype,r),s&&u(n,s),t}(o.a.Component),b=n(27),g=n(30),d=function(){return o.a.createElement("div",null,o.a.createElement("h2",null,"How to use UMC"),o.a.createElement("ol",{className:"major-ordered-list"},o.a.createElement("li",null,"Create a RSA Keypair (skip if you already have a .umc file)"),o.a.createElement("ol",{className:"minor-ordered-list"},o.a.createElement("li",null,"Go to /keymanager route"),o.a.createElement("li",null,'press "Generate Keypair" button or paste keypair from other source in the boxes'),o.a.createElement("li",null,"Choose an Alias"),o.a.createElement("li",null,'Press "Register Public Key" button'),o.a.createElement("li",null,"Your SHA-256 Fingerprint in hex from will appear in the fingerprint box once your Key has been registered"),o.a.createElement("li",null,'Optional: choose a password and press "encode" to protect your private key'),o.a.createElement("li",null,"Press Export File (will download a .umc file named with your Alias)"),o.a.createElement("li",null,"If you encoded your private key, decode it before going back to Main Page"),o.a.createElement("li",null,"return to Main Page")),o.a.createElement("li",null,"Import .umc file"),o.a.createElement("ol",{className:"minor-ordered-list"},o.a.createElement("li",null,"Go to /keymanager route"),o.a.createElement("li",null,'Press "import file" button'),o.a.createElement("li",null,'If you secured your private key with a password, enter this password and press "decode"'),o.a.createElement("li",null,"return to Main Page")),o.a.createElement("li",null,"Send someone a Message"),o.a.createElement("ol",{className:"minor-ordered-list"},o.a.createElement("li",null,'Press "Outbox" button'),o.a.createElement("li",null,"Click on an Alias in the Contacts list"),o.a.createElement("li",null,"Write a Message"),o.a.createElement("li",null,'Press "Send Message" button')),o.a.createElement("li",null,"Read a Message"),o.a.createElement("ol",{className:"minor-ordered-list"},o.a.createElement("li",null,'Press "Inbox" button'),o.a.createElement("li",null,"click on the Message you would like to read (if you have any)"),o.a.createElement("li",null,"Optional: Press Reply button to switch to Outbox with this Alias as recipient"))))},v=n(29);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?A(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"default",(function(){return M}));var M=function(e){function t(){var e,n;E(this,t);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return k(A(n=O(this,(e=P(t)).call.apply(e,[this].concat(o)))),"state",{destination:void 0,me:void 0,sub:void 0}),n}var n,r,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){b.register("MainPage");var e=b.getState("MainPage");e&&Object.keys(e).length>0&&this.setState(e)}},{key:"componentDidUpdate",value:function(){var e=this;this.state.me&&!this.state.sub&&(console.log("Ready to register push manager"),i.a.registerPushManager().then((function(t){console.log("push manager registered"),e.setState({sub:t});var n=t.endpoint,r=t.toJSON().keys,o=r.p256dh,a=r.auth,i=JSON.stringify({endpoint:n,p256dh:o,auth:a}),s=Math.round(Math.random()*Math.pow(2,32)).toString(16);console.log("signing message for API registration"),Object(v.signMessage)(s,e.state.me.privateKey,{name:"RSASSA-PKCS1-v1_5"}).then((function(t){console.log("registering push subscription with API"),fetch("/umc/subscribe/"+e.state.me.fingerprint,{method:"POST",body:i,headers:{"Content-Type":"Application/json",signature:t,nonce:s}}).then(console.log,console.log)}),console.log)}),(function(e){console.log("push manager registration error",e)})).catch(console.log))}},{key:"componentWillUnmount",value:function(){var e=this;this.state.sub&&this.state.sub.unsubscribe().then((function(t){if(t){var n=Math.round(Math.random()*Math.pow(2,32)).toString(16);Object(v.signMessage)(n,e.state.me.privateKey,{name:"RSASSA-PKCS1-v1_5"}).then((function(t){fetch("/umc/unsubscribe/"+e.state.me.fingerprint,{method:"POST",headers:{"Content-Type":"Application/json",signature:t,nonce:n}})}))}}),console.log)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"Page"},o.a.createElement(h,{selectDestination:function(t){e.setState({destination:t})},myID:function(){return e.state.me?e.state.me.fingerprint:void 0}}),this.state.me&&o.a.createElement(g.a,{me:this.state.me,destination:this.state.destination,setDestination:function(t){e.setState({destination:t})}}),!this.state.me&&o.a.createElement(d,null))}}])&&w(n.prototype,r),a&&w(n,a),t}(o.a.Component)}}]);